//
// Created by ISU on 25/06/2020.
//

#include <gtest/gtest.h>

#include <vector>
#include <array>
#include <iostream>

#include <ortools/constraint_solver/constraint_solver.h>
#include <ortools/sat/cp_model.h>
#include <ortools/sat/integer_expr.h>

class OrtoolsFixture : public ::testing::Test
{
protected:

    void SetUp() override
    {
    }

    void TearDown() override
    {
    }

};

TEST_F(OrtoolsFixture, OriginalSatTest)
{
    GTEST_SKIP();
    using namespace operations_research;

    Solver solver("cryptoengine");

    std::array<int, 4> blocks = {1, 2, 3, 4};
    std::array<int, 2> devices = {1, 40};

    using Processor = std::vector<int64>;
    std::vector<Processor> processors = {
            { 13, 8, 5, 5, 5, 5, 5, 5, 5 },
            { 13, 7, 7, 6, 4, 1, 1, 1, 1 }
    };

    // TODO: performance of INF horizon
    int64 horizon = INT64_MAX;

    struct Task {
        IntervalVar * p_interval;
        IntervalVar * io_interval;
        int64 block_len;
    };

    std::vector<IntervalVar*> all_p_intervals;
    std::vector<std::vector<IntervalVar*>> device_tasks(devices.size());
    std::vector<IntervalVar*> all_io_intervals;

    std::vector<std::vector<std::vector<Task>>> all_tasks(processors.size());

    for (int proc_id = 0; proc_id < processors.size(); proc_id++)
    {
        all_tasks[proc_id] = std::vector<std::vector<Task>>(devices.size());
        for (int device_id = 0; device_id < devices.size(); device_id++)
        {
            all_tasks[proc_id][device_id] = std::vector<Task>(blocks.size());
            for (int block_id = 0; block_id < blocks.size(); block_id++)
            {
                std::stringstream ss;
                ss << "_" << block_id << "_" << proc_id << "_" << device_id;
                IntVar *chosen = solver.MakeIntVar(0, 1, "chosen" + ss.str());

                int64 p_time = blocks[block_id] * processors[proc_id][block_id];
                IntVar *p_start = solver.MakeIntVar(0, horizon, "p_start" + ss.str());
                IntervalVar *p_interval = solver.MakeFixedDurationIntervalVar(p_start, p_time, chosen,
                        "p_interval" + ss.str());
                all_p_intervals.push_back(p_interval);

                int64 io_time = blocks[block_id] * devices[device_id];
                IntVar *io_start = solver.MakeIntVar(0, horizon, "io_start" + ss.str());
                IntervalVar *io_interval = solver.MakeFixedDurationIntervalVar(io_start, io_time, chosen,
                        "io_interval" + ss.str());
                device_tasks[device_id].push_back(io_interval);
                all_io_intervals.push_back(io_interval);

                /// Precedence constraint
                solver.AddConstraint(solver.MakeIntervalVarRelation(io_interval, Solver::STARTS_AFTER_END, p_interval));
                all_tasks[proc_id][device_id][block_id] = Task{p_interval, io_interval, blocks[block_id]};
            }
        }
    }

    std::vector<SequenceVar*> p_sequences;
    auto p_no_overlap = solver.MakeDisjunctiveConstraint(all_p_intervals, "no_overlap_p_task");
    solver.AddConstraint(p_no_overlap);
    p_sequences.push_back(p_no_overlap->MakeSequenceVar());

    std::vector<std::vector<SequenceVar*>> io_sequences(devices.size());
    for (int device_id = 0; device_id < devices.size(); device_id++)
    {
        auto no_overlap = solver.MakeDisjunctiveConstraint(device_tasks[device_id], "no_overlap_io_" + std::to_string(device_id));
        solver.AddConstraint(no_overlap);
        io_sequences[device_id].push_back(no_overlap->MakeSequenceVar());
    }

    std::vector<IntVar*> all_ends;
    for (auto &io_interval : all_io_intervals)
    {
        all_ends.push_back(io_interval->EndExpr()->Var());
    }
    IntVar * obj_var = solver.MakeMax(all_ends)->Var();
    OptimizeVar * objective_monitor = solver.MakeMinimize(obj_var, 1);

    std::vector<DecisionBuilder*> all_decisions;
    all_decisions.push_back(solver.MakePhase(p_sequences, Solver::SEQUENCE_DEFAULT));
    for (int device_id = 0; device_id < devices.size(); device_id++)
        all_decisions.push_back(solver.MakePhase(io_sequences[device_id], Solver::SEQUENCE_DEFAULT));
    all_decisions.push_back(solver.MakePhase(obj_var, Solver::CHOOSE_FIRST_UNBOUND, Solver::ASSIGN_MIN_VALUE));
    DecisionBuilder * main_phase = solver.Compose(all_decisions);

    const int kLogFreq = 1000000;
    SearchMonitor * search_log = solver.MakeSearchLog(kLogFreq, objective_monitor);

    SearchLimit * limit = nullptr;

    SolutionCollector * collector = solver.MakeLastSolutionCollector();
    collector->AddObjective(obj_var);
    for (auto &sequence : p_sequences)
    {
        for (int i = 0; i < sequence->size(); i++)
        {
            auto interval = sequence->Interval(i);
            collector->Add(interval);
        }
    }
    for (int device_id = 0; device_id < devices.size(); device_id++)
    {
        for (auto &sequence : io_sequences[device_id])
        {
            for (int i = 0; i < sequence->size(); i++)
            {
                auto interval = sequence->Interval(i);
                collector->Add(interval);
            }
        }
    }

    if (!solver.Solve(main_phase, search_log, objective_monitor, limit, collector))
    {
        std::cerr << "Could not solve" << std::endl;
        FAIL();
    }

    std::cout << "Optimal Schedule Length: " << collector->objective_value(0) << "\n";
    std::stringstream processor_tasks;
    for (int proc_id = 0; proc_id < processors.size(); proc_id++)
    {
        for (int device_id = 0; device_id < devices.size(); device_id++)
        {
            processor_tasks << "Processor " << proc_id << " by " << device_id << " : \n";

            std::stringstream times;
            for (int block_id = 0; block_id < blocks.size(); block_id++)
            {
                auto &task = all_tasks[proc_id][device_id][block_id];
                if (collector->PerformedValue(0, task.p_interval) != 1)
                {
                    continue;
                }

                processor_tasks << "block " << task.block_len << " B | ";

                times << "p: [" << std::setw(10)
                      << collector->Value(0, task.p_interval->StartExpr()->Var()) << ", "
                      << std::setw(10)
                      << collector->Value(0, task.p_interval->EndExpr()->Var()) << "] ";

                times << "io: [" << std::setw(10)
                      << collector->Value(0, task.io_interval->StartExpr()->Var()) << ", "
                      << std::setw(10)
                      << collector->Value(0, task.io_interval->EndExpr()->Var()) << "] | ";
            }
            processor_tasks << "\n" << times.str() << "\n";
        }
    }

    std::cout << processor_tasks.str() << std::endl;
}

TEST_F(OrtoolsFixture, CpModelTest)
{
    const int64 FILE_SIZE = 1280;
    const int SEC_LEVEL = 2;

    using namespace operations_research;

    std::array<int, 19> blocks = {1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144};
    std::array<int, 3> devices = { 1, 40, 80 };

    std::vector<std::string> cipher_names = {"cryptopp-AES-128-CBC", "cryptopp-AES-128-CBC", "cryptopp-AES-128-CFB", "cryptopp-AES-128-CFB", "cryptopp-AES-128-CTR", "cryptopp-AES-128-CTR", "cryptopp-AES-128-ECB", "cryptopp-AES-128-OFB", "cryptopp-AES-128-OFB", "cryptopp-AES-192-CBC", "cryptopp-AES-192-CBC", "cryptopp-AES-192-CFB", "cryptopp-AES-192-CFB", "cryptopp-AES-192-CTR", "cryptopp-AES-192-CTR", "cryptopp-AES-192-ECB", "cryptopp-AES-192-OFB", "cryptopp-AES-192-OFB", "cryptopp-AES-256-CBC", "cryptopp-AES-256-CBC", "cryptopp-AES-256-CBC", "cryptopp-AES-256-CFB", "cryptopp-AES-256-CFB", "cryptopp-AES-256-CFB", "cryptopp-AES-256-CTR", "cryptopp-AES-256-CTR", "cryptopp-AES-256-CTR", "cryptopp-AES-256-ECB", "cryptopp-AES-256-ECB", "cryptopp-AES-256-OFB", "cryptopp-AES-256-OFB", "cryptopp-AES-256-OFB", "cryptopp-ARIA-128-CBC", "cryptopp-ARIA-128-CBC", "cryptopp-ARIA-128-CFB", "cryptopp-ARIA-128-CFB", "cryptopp-ARIA-128-CTR", "cryptopp-ARIA-128-CTR", "cryptopp-ARIA-128-ECB", "cryptopp-ARIA-128-OFB", "cryptopp-ARIA-128-OFB", "cryptopp-ARIA-192-CBC", "cryptopp-ARIA-192-CBC", "cryptopp-ARIA-192-CBC", "cryptopp-ARIA-192-CFB", "cryptopp-ARIA-192-CFB", "cryptopp-ARIA-192-CFB", "cryptopp-ARIA-192-CTR", "cryptopp-ARIA-192-CTR", "cryptopp-ARIA-192-CTR", "cryptopp-ARIA-192-ECB", "cryptopp-ARIA-192-OFB", "cryptopp-ARIA-192-OFB", "cryptopp-ARIA-192-OFB", "cryptopp-ARIA-256-CBC", "cryptopp-ARIA-256-CBC", "cryptopp-ARIA-256-CBC", "cryptopp-ARIA-256-CFB", "cryptopp-ARIA-256-CFB", "cryptopp-ARIA-256-CFB", "cryptopp-ARIA-256-CTR", "cryptopp-ARIA-256-CTR", "cryptopp-ARIA-256-CTR", "cryptopp-ARIA-256-ECB", "cryptopp-ARIA-256-ECB", "cryptopp-ARIA-256-OFB", "cryptopp-ARIA-256-OFB", "cryptopp-ARIA-256-OFB", "cryptopp-BLOWFISH-256-CFB", "cryptopp-BLOWFISH-256-OFB", "cryptopp-CAMELLIA-128-CBC", "cryptopp-CAMELLIA-128-CBC", "cryptopp-CAMELLIA-128-CBC", "cryptopp-CAMELLIA-128-CFB", "cryptopp-CAMELLIA-128-CFB", "cryptopp-CAMELLIA-128-CFB", "cryptopp-CAMELLIA-128-CTR", "cryptopp-CAMELLIA-128-CTR", "cryptopp-CAMELLIA-128-CTR", "cryptopp-CAMELLIA-128-ECB", "cryptopp-CAMELLIA-128-ECB", "cryptopp-CAMELLIA-128-OFB", "cryptopp-CAMELLIA-128-OFB", "cryptopp-CAMELLIA-128-OFB", "cryptopp-CAMELLIA-192-CBC", "cryptopp-CAMELLIA-192-CBC", "cryptopp-CAMELLIA-192-CBC", "cryptopp-CAMELLIA-192-CFB", "cryptopp-CAMELLIA-192-CFB", "cryptopp-CAMELLIA-192-CFB", "cryptopp-CAMELLIA-192-CTR", "cryptopp-CAMELLIA-192-CTR", "cryptopp-CAMELLIA-192-CTR", "cryptopp-CAMELLIA-192-ECB", "cryptopp-CAMELLIA-192-ECB", "cryptopp-CAMELLIA-192-OFB", "cryptopp-CAMELLIA-192-OFB", "cryptopp-CAMELLIA-192-OFB", "cryptopp-CAMELLIA-256-CBC", "cryptopp-CAMELLIA-256-CBC", "cryptopp-CAMELLIA-256-CBC", "cryptopp-CAMELLIA-256-CFB", "cryptopp-CAMELLIA-256-CFB", "cryptopp-CAMELLIA-256-CFB", "cryptopp-CAMELLIA-256-CTR", "cryptopp-CAMELLIA-256-CTR", "cryptopp-CAMELLIA-256-CTR", "cryptopp-CAMELLIA-256-ECB", "cryptopp-CAMELLIA-256-ECB", "cryptopp-CAMELLIA-256-OFB", "cryptopp-CAMELLIA-256-OFB", "cryptopp-CAMELLIA-256-OFB", "gcrypt-AES-128-CFB", "gcrypt-AES-128-CFB", "gcrypt-AES-128-CTR", "gcrypt-AES-128-CTR", "gcrypt-AES-128-OFB", "gcrypt-AES-128-OFB", "gcrypt-AES-192-CFB", "gcrypt-AES-192-CFB", "gcrypt-AES-192-CTR", "gcrypt-AES-192-CTR", "gcrypt-AES-192-OFB", "gcrypt-AES-192-OFB", "gcrypt-AES-256-CFB", "gcrypt-AES-256-CFB", "gcrypt-AES-256-CFB", "gcrypt-AES-256-CTR", "gcrypt-AES-256-CTR", "gcrypt-AES-256-CTR", "gcrypt-AES-256-OFB", "gcrypt-AES-256-OFB", "gcrypt-AES-256-OFB", "gcrypt-BLOWFISH-128-CTR", "gcrypt-BLOWFISH-128-CTR", "gcrypt-BLOWFISH-192-CFB", "gcrypt-BLOWFISH-192-CFB", "gcrypt-BLOWFISH-192-CTR", "gcrypt-BLOWFISH-192-CTR", "gcrypt-BLOWFISH-256-CFB", "gcrypt-BLOWFISH-256-CFB", "gcrypt-BLOWFISH-256-CFB", "gcrypt-BLOWFISH-256-CTR", "gcrypt-BLOWFISH-256-CTR", "gcrypt-BLOWFISH-256-CTR", "gcrypt-BLOWFISH-448-CFB", "gcrypt-BLOWFISH-448-CFB", "gcrypt-BLOWFISH-448-CFB", "gcrypt-BLOWFISH-448-CTR", "gcrypt-BLOWFISH-448-CTR", "gcrypt-BLOWFISH-448-CTR", "gcrypt-CAMELLIA-128-CFB", "gcrypt-CAMELLIA-128-CFB", "gcrypt-CAMELLIA-128-CFB", "gcrypt-CAMELLIA-128-CTR", "gcrypt-CAMELLIA-128-CTR", "gcrypt-CAMELLIA-128-CTR", "gcrypt-CAMELLIA-128-OFB", "gcrypt-CAMELLIA-192-CFB", "gcrypt-CAMELLIA-192-CFB", "gcrypt-CAMELLIA-192-CFB", "gcrypt-CAMELLIA-192-CTR", "gcrypt-CAMELLIA-192-CTR", "gcrypt-CAMELLIA-192-CTR", "gcrypt-CAMELLIA-256-CFB", "gcrypt-CAMELLIA-256-CFB", "gcrypt-CAMELLIA-256-CFB", "gcrypt-CAMELLIA-256-CTR", "gcrypt-CAMELLIA-256-CTR", "gcrypt-CAMELLIA-256-CTR", "openssl-AES-128-CBC", "openssl-AES-128-CBC", "openssl-AES-128-CFB", "openssl-AES-128-CFB", "openssl-AES-128-CTR", "openssl-AES-128-CTR", "openssl-AES-128-ECB", "openssl-AES-128-OFB", "openssl-AES-128-OFB", "openssl-AES-128-XTS", "openssl-AES-128-XTS", "openssl-AES-128-XTS", "openssl-AES-192-CBC", "openssl-AES-192-CBC", "openssl-AES-192-CFB", "openssl-AES-192-CFB", "openssl-AES-192-CTR", "openssl-AES-192-CTR", "openssl-AES-192-ECB", "openssl-AES-192-OFB", "openssl-AES-192-OFB", "openssl-AES-256-CBC", "openssl-AES-256-CBC", "openssl-AES-256-CBC", "openssl-AES-256-CFB", "openssl-AES-256-CFB", "openssl-AES-256-CFB", "openssl-AES-256-CTR", "openssl-AES-256-CTR", "openssl-AES-256-CTR", "openssl-AES-256-ECB", "openssl-AES-256-ECB", "openssl-AES-256-OFB", "openssl-AES-256-OFB", "openssl-AES-256-OFB", "openssl-AES-256-XTS", "openssl-AES-256-XTS", "openssl-AES-256-XTS", "openssl-AES-256-XTS", "openssl-ARIA-128-CBC", "openssl-ARIA-128-CBC", "openssl-ARIA-128-CFB", "openssl-ARIA-128-CFB", "openssl-ARIA-128-CTR", "openssl-ARIA-128-CTR", "openssl-ARIA-128-ECB", "openssl-ARIA-128-OFB", "openssl-ARIA-128-OFB", "openssl-ARIA-192-CBC", "openssl-ARIA-192-CBC", "openssl-ARIA-192-CBC", "openssl-ARIA-192-CFB", "openssl-ARIA-192-CFB", "openssl-ARIA-192-CFB", "openssl-ARIA-192-CTR", "openssl-ARIA-192-CTR", "openssl-ARIA-192-CTR", "openssl-ARIA-192-ECB", "openssl-ARIA-192-OFB", "openssl-ARIA-192-OFB", "openssl-ARIA-192-OFB", "openssl-ARIA-256-CBC", "openssl-ARIA-256-CBC", "openssl-ARIA-256-CBC", "openssl-ARIA-256-CFB", "openssl-ARIA-256-CFB", "openssl-ARIA-256-CFB", "openssl-ARIA-256-CTR", "openssl-ARIA-256-CTR", "openssl-ARIA-256-CTR", "openssl-ARIA-256-ECB", "openssl-ARIA-256-ECB", "openssl-ARIA-256-OFB", "openssl-ARIA-256-OFB", "openssl-ARIA-256-OFB", "openssl-BLOWFISH-128-CBC", "openssl-BLOWFISH-128-CBC", "openssl-BLOWFISH-128-ECB", "openssl-BLOWFISH-192-CBC", "openssl-BLOWFISH-192-CBC", "openssl-BLOWFISH-192-CFB", "openssl-BLOWFISH-192-CFB", "openssl-BLOWFISH-192-OFB", "openssl-BLOWFISH-192-OFB", "openssl-BLOWFISH-256-CBC", "openssl-BLOWFISH-256-CBC", "openssl-BLOWFISH-256-CBC", "openssl-BLOWFISH-256-ECB", "openssl-BLOWFISH-256-OFB", "openssl-BLOWFISH-448-CBC", "openssl-BLOWFISH-448-CBC", "openssl-BLOWFISH-448-CBC", "openssl-BLOWFISH-448-CFB", "openssl-BLOWFISH-448-CFB", "openssl-BLOWFISH-448-ECB", "openssl-BLOWFISH-448-OFB", "openssl-BLOWFISH-448-OFB", "openssl-BLOWFISH-448-OFB", "openssl-SEED-128-CBC", "openssl-SEED-128-CBC", "openssl-SEED-128-CBC", "openssl-SEED-128-CFB", "openssl-SEED-128-CFB", "openssl-SEED-128-CFB", "openssl-SEED-128-ECB", "openssl-SEED-128-OFB", "wolfcrypt-AES-128-CTR", "wolfcrypt-AES-128-CTR", "wolfcrypt-AES-192-CTR", "wolfcrypt-AES-192-CTR", "wolfcrypt-AES-256-CTR", "wolfcrypt-AES-256-CTR", "wolfcrypt-AES-256-CTR" };

    std::vector<int> sec_levels = {1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 3, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 4, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 3, 1, 3, 1, 2, 3, 2, 3, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 3, 1, 2, 1, 2, 1, 2, 3 };

    using Processor = std::vector<int64>;
    std::vector<Processor> processors = {
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62560099, 33873349, 18454058, 10456768, 6769572, 4859975, 3779835, 3208666, 2956596 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62560099, 33873349, 18454058, 10456768, 6769572, 4859975, 3779835, 3208666, 2956596 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107633422, 59026977, 33991129, 17064530, 10486232, 6479958, 4696964, 3892226, 3460078, 3150268 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107633422, 59026977, 33991129, 17064530, 10486232, 6479958, 4696964, 3892226, 3460078, 3150268 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59284098, 30437123, 15904747, 8903467, 5238079, 3204850, 2296586, 1885948, 1609633 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59284098, 30437123, 15904747, 8903467, 5238079, 3204850, 2296586, 1885948, 1609633 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60427357, 32053029, 16644607, 8766162, 5204563, 3364824, 2667174, 1786552, 1679524 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65187240, 34460642, 19517031, 11936246, 8028706, 5973840, 5055578, 4698687, 4556805 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65187240, 34460642, 19517031, 11936246, 8028706, 5973840, 5055578, 4698687, 4556805 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39750211, 22061453, 12811244, 7833007, 5671184, 4238752, 3715607, 3527481 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39750211, 22061453, 12811244, 7833007, 5671184, 4238752, 3715607, 3527481 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38022466, 20222979, 12152638, 7982666, 5709275, 5888680, 4209359, 4618006 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38022466, 20222979, 12152638, 7982666, 5709275, 5888680, 4209359, 4618006 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37140586, 19420494, 10555635, 5906565, 3776608, 2686742, 2093332, 1756688 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37140586, 19420494, 10555635, 5906565, 3776608, 2686742, 2093332, 1756688 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39051434, 20912564, 11035723, 6245292, 3815206, 2649503, 2189431, 1977176 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24563826, 14087914, 11062983, 7269877, 6521903, 5296317, 5039811 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24563826, 14087914, 11062983, 7269877, 6521903, 5296317, 5039811 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40962285, 20947615, 12879388, 8105266, 6011118, 4755755, 4087923, 3730304 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40962285, 20947615, 12879388, 8105266, 6011118, 4755755, 4087923, 3730304 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40962285, 20947615, 12879388, 8105266, 6011118, 4755755, 4087923, 3730304 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38798848, 21640946, 12754719, 8467947, 6370102, 5852035, 4949417, 4450674 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38798848, 21640946, 12754719, 8467947, 6370102, 5852035, 4949417, 4450674 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38798848, 21640946, 12754719, 8467947, 6370102, 5852035, 4949417, 4450674 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37926681, 19785268, 10736923, 6433140, 3951607, 2806043, 2251466, 1953337 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37926681, 19785268, 10736923, 6433140, 3951607, 2806043, 2251466, 1953337 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37926681, 19785268, 10736923, 6433140, 3951607, 2806043, 2251466, 1953337 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36092419, 20403912, 11270020, 5944371, 3917502, 2791864, 2556328, 1844867 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36092419, 20403912, 11270020, 5944371, 3917502, 2791864, 2556328, 1844867 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42487945, 22843227, 14710213, 10469187, 7672036, 6727366, 6073827, 6143329 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42487945, 22843227, 14710213, 10469187, 7672036, 6727366, 6073827, 6143329 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42487945, 22843227, 14710213, 10469187, 7672036, 6727366, 6073827, 6143329 },
            {2549474666666, 1241258500000, 623595166666, 310258083333, 158361583333, 78841281250, 39058526041, 19788195312, 9960941406, 4871896484, 2461068033, 1232671712, 655792236, 334253255, 180510701, 106857533, 60180145, 39183957, 27633931, 22854074, 0, 0, 0, 0, 0 },
            {2549474666666, 1241258500000, 623595166666, 310258083333, 158361583333, 78841281250, 39058526041, 19788195312, 9960941406, 4871896484, 2461068033, 1232671712, 655792236, 334253255, 180510701, 106857533, 60180145, 39183957, 27633931, 22854074, 0, 0, 0, 0, 0 },
            {2340359333333, 1212389000000, 592742833333, 293983583333, 148829625000, 73355677083, 37044380208, 18582161458, 9285014322, 4694729817, 2338342773, 1209335449, 586254069, 320237874, 171626302, 97930674, 0, 37449264, 27905382, 22909043, 19439961, 0, 0, 0, 0 },
            {2340359333333, 1212389000000, 592742833333, 293983583333, 148829625000, 73355677083, 37044380208, 18582161458, 9285014322, 4694729817, 2338342773, 1209335449, 586254069, 320237874, 171626302, 97930674, 0, 37449264, 27905382, 22909043, 19439961, 0, 0, 0, 0 },
            {2373356333333, 1161341666666, 590094083333, 286479958333, 143295770833, 72305437500, 35805661458, 17850322916, 9147204427, 0, 2312021484, 1203257486, 612327311, 326747070, 176768147, 98889892, 53820348, 41034210, 26859503, 22940800, 0, 0, 0, 0, 0 },
            {2373356333333, 1161341666666, 590094083333, 286479958333, 143295770833, 72305437500, 35805661458, 17850322916, 9147204427, 0, 2312021484, 1203257486, 612327311, 326747070, 176768147, 98889892, 53820348, 41034210, 26859503, 22940800, 0, 0, 0, 0, 0 },
            {2485250000000, 1145584666666, 603596583333, 297832458333, 153947312500, 78301625000, 36909083333, 18783945312, 9206423177, 5074217447, 2468801757, 1189689290, 631800048, 326090901, 179881347, 98991516, 58579823, 39413108, 27808645, 22303276, 0, 0, 0, 0, 0 },
            {2404719333333, 1178010833333, 586080916666, 280296666666, 146189416666, 80364604166, 35395390625, 18094291666, 9103044270, 4487514973, 2226976888, 1176283854, 587487792, 324307006, 178974772, 94764455, 55652893, 39247497, 27193052, 22132385, 19816546, 0, 0, 0, 0 },
            {2404719333333, 1178010833333, 586080916666, 280296666666, 146189416666, 80364604166, 35395390625, 18094291666, 9103044270, 4487514973, 2226976888, 1176283854, 587487792, 324307006, 178974772, 94764455, 55652893, 39247497, 27193052, 22132385, 19816546, 0, 0, 0, 0 },
            {2597975666666, 1295492000000, 640506083333, 319659791666, 159934645833, 82297552083, 40610916666, 19910247395, 10192934895, 4971023437, 2554067057, 1322675130, 659148518, 354065714, 191834045, 104800201, 64326929, 43914499, 30676038, 25159292, 0, 0, 0, 0, 0 },
            {2597975666666, 1295492000000, 640506083333, 319659791666, 159934645833, 82297552083, 40610916666, 19910247395, 10192934895, 4971023437, 2554067057, 1322675130, 659148518, 354065714, 191834045, 104800201, 64326929, 43914499, 30676038, 25159292, 0, 0, 0, 0, 0 },
            {2597975666666, 1295492000000, 640506083333, 319659791666, 159934645833, 82297552083, 40610916666, 19910247395, 10192934895, 4971023437, 2554067057, 1322675130, 659148518, 354065714, 191834045, 104800201, 64326929, 43914499, 30676038, 25159292, 0, 0, 0, 0, 0 },
            {0, 1140547166666, 580150916666, 295673125000, 144182000000, 72274958333, 36339171875, 18240518229, 8911873697, 4562270182, 2283576171, 1150701822, 590669270, 327077392, 171670979, 97362294, 59216842, 39284586, 30252466, 25510381, 21574898, 20475987, 0, 0, 0 },
            {0, 1140547166666, 580150916666, 295673125000, 144182000000, 72274958333, 36339171875, 18240518229, 8911873697, 4562270182, 2283576171, 1150701822, 590669270, 327077392, 171670979, 97362294, 59216842, 39284586, 30252466, 25510381, 21574898, 20475987, 0, 0, 0 },
            {0, 1140547166666, 580150916666, 295673125000, 144182000000, 72274958333, 36339171875, 18240518229, 8911873697, 4562270182, 2283576171, 1150701822, 590669270, 327077392, 171670979, 97362294, 59216842, 39284586, 30252466, 25510381, 21574898, 20475987, 0, 0, 0 },
            {2293082666666, 1169851666666, 590653250000, 292039166666, 142210187500, 72068427083, 35461088541, 18450364583, 9127115885, 4532985026, 2189237955, 1153301757, 599193522, 317487752, 179449218, 95600545, 57522893, 41794799, 29963394, 23956087, 0, 0, 0, 0, 0 },
            {2293082666666, 1169851666666, 590653250000, 292039166666, 142210187500, 72068427083, 35461088541, 18450364583, 9127115885, 4532985026, 2189237955, 1153301757, 599193522, 317487752, 179449218, 95600545, 57522893, 41794799, 29963394, 23956087, 0, 0, 0, 0, 0 },
            {2293082666666, 1169851666666, 590653250000, 292039166666, 142210187500, 72068427083, 35461088541, 18450364583, 9127115885, 4532985026, 2189237955, 1153301757, 599193522, 317487752, 179449218, 95600545, 57522893, 41794799, 29963394, 23956087, 0, 0, 0, 0, 0 },
            {2581070666666, 1268535666666, 654919916666, 317449041666, 164046000000, 79212447916, 41142401041, 20961380208, 9990897135, 5029639322, 2518748697, 1265682779, 670910074, 335992838, 190949401, 0, 60854827, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2345911333333, 1122892000000, 569246750000, 292887708333, 138255750000, 70581895833, 34881968750, 17583572916, 9022105468, 4352496744, 2303465169, 1135562011, 584506998, 327267211, 171084940, 100757975, 60714879, 40759836, 30307191, 24105846, 0, 0, 0, 0, 0 },
            {2345911333333, 1122892000000, 569246750000, 292887708333, 138255750000, 70581895833, 34881968750, 17583572916, 9022105468, 4352496744, 2303465169, 1135562011, 584506998, 327267211, 171084940, 100757975, 60714879, 40759836, 30307191, 24105846, 0, 0, 0, 0, 0 },
            {2345911333333, 1122892000000, 569246750000, 292887708333, 138255750000, 70581895833, 34881968750, 17583572916, 9022105468, 4352496744, 2303465169, 1135562011, 584506998, 327267211, 171084940, 100757975, 60714879, 40759836, 30307191, 24105846, 0, 0, 0, 0, 0 },
            {2651661000000, 1302202666666, 646565666666, 322125958333, 171249770833, 82231739583, 41850401041, 20598507812, 10419881510, 5291923828, 2665311197, 1311694498, 691775227, 344851277, 0, 108616414, 0, 43977104, 0, 0, 0, 0, 0, 0, 0 },
            {2651661000000, 1302202666666, 646565666666, 322125958333, 171249770833, 82231739583, 41850401041, 20598507812, 10419881510, 5291923828, 2665311197, 1311694498, 691775227, 344851277, 0, 108616414, 0, 43977104, 0, 0, 0, 0, 0, 0, 0 },
            {2651661000000, 1302202666666, 646565666666, 322125958333, 171249770833, 82231739583, 41850401041, 20598507812, 10419881510, 5291923828, 2665311197, 1311694498, 691775227, 344851277, 0, 108616414, 0, 43977104, 0, 0, 0, 0, 0, 0, 0 },
            {2248630333333, 1176323500000, 592356750000, 288783083333, 144671187500, 74957656250, 37265359375, 17891231770, 8844135416, 4695324218, 2249983072, 1174327636, 604588460, 323760294, 172667277, 95425018, 64044372, 42397982, 32188275, 0, 0, 0, 0, 0, 0 },
            {2248630333333, 1176323500000, 592356750000, 288783083333, 144671187500, 74957656250, 37265359375, 17891231770, 8844135416, 4695324218, 2249983072, 1174327636, 604588460, 323760294, 172667277, 95425018, 64044372, 42397982, 32188275, 0, 0, 0, 0, 0, 0 },
            {2248630333333, 1176323500000, 592356750000, 288783083333, 144671187500, 74957656250, 37265359375, 17891231770, 8844135416, 4695324218, 2249983072, 1174327636, 604588460, 323760294, 172667277, 95425018, 64044372, 42397982, 32188275, 0, 0, 0, 0, 0, 0 },
            {2232288666666, 1177561666666, 583403833333, 282065291666, 141955708333, 70781416666, 35506041666, 18239247395, 9082106770, 4556270182, 2317113932, 1164632812, 599900227, 320934285, 169587585, 99340861, 61722223, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2232288666666, 1177561666666, 583403833333, 282065291666, 141955708333, 70781416666, 35506041666, 18239247395, 9082106770, 4556270182, 2317113932, 1164632812, 599900227, 320934285, 169587585, 99340861, 61722223, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2232288666666, 1177561666666, 583403833333, 282065291666, 141955708333, 70781416666, 35506041666, 18239247395, 9082106770, 4556270182, 2317113932, 1164632812, 599900227, 320934285, 169587585, 99340861, 61722223, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2725247666666, 1244285500000, 0, 347628708333, 174937041666, 86298979166, 43424729166, 22001317708, 9795360677, 5323257161, 2719331054, 1333094563, 695022298, 365826253, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2725247666666, 1244285500000, 0, 347628708333, 174937041666, 86298979166, 43424729166, 22001317708, 9795360677, 5323257161, 2719331054, 1333094563, 695022298, 365826253, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2196793666666, 1147640833333, 571443666666, 288329916666, 142304291666, 74262427083, 36248713541, 18361046875, 9056214843, 4612059895, 2205699544, 1098939290, 598551269, 333951904, 0, 102292409, 0, 44120058, 0, 0, 0, 0, 0, 0, 0 },
            {2196793666666, 1147640833333, 571443666666, 288329916666, 142304291666, 74262427083, 36248713541, 18361046875, 9056214843, 4612059895, 2205699544, 1098939290, 598551269, 333951904, 0, 102292409, 0, 44120058, 0, 0, 0, 0, 0, 0, 0 },
            {2196793666666, 1147640833333, 571443666666, 288329916666, 142304291666, 74262427083, 36248713541, 18361046875, 9056214843, 4612059895, 2205699544, 1098939290, 598551269, 333951904, 0, 102292409, 0, 44120058, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20566385, 19222076, 18798830, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32537456, 0, 22414267, 0, 0, 0, 0 },
            {2472843666666, 1321314166666, 648019416666, 318993708333, 152182416666, 80760656250, 38458625000, 19547229166, 9839312500, 5171741536, 2516404296, 1217909342, 645124186, 332139444, 183418294, 99213887, 59341735, 35772392, 27077275, 21674275, 22076448, 17430830, 16876107, 16392516, 16320991 },
            {2472843666666, 1321314166666, 648019416666, 318993708333, 152182416666, 80760656250, 38458625000, 19547229166, 9839312500, 5171741536, 2516404296, 1217909342, 645124186, 332139444, 183418294, 99213887, 59341735, 35772392, 27077275, 21674275, 22076448, 17430830, 16876107, 16392516, 16320991 },
            {2472843666666, 1321314166666, 648019416666, 318993708333, 152182416666, 80760656250, 38458625000, 19547229166, 9839312500, 5171741536, 2516404296, 1217909342, 645124186, 332139444, 183418294, 99213887, 59341735, 35772392, 27077275, 21674275, 22076448, 17430830, 16876107, 16392516, 16320991 },
            {2833445333333, 1410299166666, 676626250000, 312325208333, 181023937500, 87433541666, 42495197916, 22153067708, 11171549479, 5301285156, 2812835611, 1399362467, 704759195, 346689005, 0, 107935557, 61284317, 40560170, 28298135, 22251666, 19593217, 18218094, 17289050, 16051179, 15885925 },
            {2833445333333, 1410299166666, 676626250000, 312325208333, 181023937500, 87433541666, 42495197916, 22153067708, 11171549479, 5301285156, 2812835611, 1399362467, 704759195, 346689005, 0, 107935557, 61284317, 40560170, 28298135, 22251666, 19593217, 18218094, 17289050, 16051179, 15885925 },
            {2833445333333, 1410299166666, 676626250000, 312325208333, 181023937500, 87433541666, 42495197916, 22153067708, 11171549479, 5301285156, 2812835611, 1399362467, 704759195, 346689005, 0, 107935557, 61284317, 40560170, 28298135, 22251666, 19593217, 18218094, 17289050, 16051179, 15885925 },
            {0, 0, 715711333333, 360968416666, 0, 0, 44048671875, 20123187500, 0, 5630126302, 2512191731, 1431939127, 0, 0, 191820983, 0, 66027252, 37142117, 30266098, 23239415, 18793054, 17865205, 16600382, 16977237, 16009438 },
            {0, 0, 715711333333, 360968416666, 0, 0, 44048671875, 20123187500, 0, 5630126302, 2512191731, 1431939127, 0, 0, 191820983, 0, 66027252, 37142117, 30266098, 23239415, 18793054, 17865205, 16600382, 16977237, 16009438 },
            {0, 0, 715711333333, 360968416666, 0, 0, 44048671875, 20123187500, 0, 5630126302, 2512191731, 1431939127, 0, 0, 191820983, 0, 66027252, 37142117, 30266098, 23239415, 18793054, 17865205, 16600382, 16977237, 16009438 },
            {2846491000000, 1410948500000, 0, 0, 0, 0, 44303203125, 21944377604, 11311852864, 0, 2785402343, 0, 0, 377567586, 204522542, 105250091, 0, 42416643, 28023380, 22700024, 0, 17425425, 0, 0, 0 },
            {2846491000000, 1410948500000, 0, 0, 0, 0, 44303203125, 21944377604, 11311852864, 0, 2785402343, 0, 0, 377567586, 204522542, 105250091, 0, 42416643, 28023380, 22700024, 0, 17425425, 0, 0, 0 },
            {0, 0, 723134750000, 0, 0, 0, 43453901041, 0, 0, 0, 0, 0, 716001871, 0, 0, 102929880, 60659627, 42804100, 28491780, 21542773, 19862154, 17769420, 16515096, 16881479, 16356364 },
            {0, 0, 723134750000, 0, 0, 0, 43453901041, 0, 0, 0, 0, 0, 716001871, 0, 0, 102929880, 60659627, 42804100, 28491780, 21542773, 19862154, 17769420, 16515096, 16881479, 16356364 },
            {0, 0, 723134750000, 0, 0, 0, 43453901041, 0, 0, 0, 0, 0, 716001871, 0, 0, 102929880, 60659627, 42804100, 28491780, 21542773, 19862154, 17769420, 16515096, 16881479, 16356364 },
            {2599684000000, 1299349500000, 664733750000, 327827541666, 161616520833, 80556791666, 40201244791, 20393554687, 9866324218, 4849887369, 2492325846, 1265929036, 671777587, 354879679, 188290283, 105579030, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2599684000000, 1299349500000, 664733750000, 327827541666, 161616520833, 80556791666, 40201244791, 20393554687, 9866324218, 4849887369, 2492325846, 1265929036, 671777587, 354879679, 188290283, 105579030, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2599684000000, 1299349500000, 664733750000, 327827541666, 161616520833, 80556791666, 40201244791, 20393554687, 9866324218, 4849887369, 2492325846, 1265929036, 671777587, 354879679, 188290283, 105579030, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1351713833333, 699719833333, 351344791666, 176755354166, 84423583333, 43463875000, 22261843750, 11169389322, 5631187500, 2728235351, 0, 0, 0, 209109578, 0, 0, 43545600, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1351713833333, 699719833333, 351344791666, 176755354166, 84423583333, 43463875000, 22261843750, 11169389322, 5631187500, 2728235351, 0, 0, 0, 209109578, 0, 0, 43545600, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1351713833333, 699719833333, 351344791666, 176755354166, 84423583333, 43463875000, 22261843750, 11169389322, 5631187500, 2728235351, 0, 0, 0, 209109578, 0, 0, 43545600, 0, 0, 0, 0, 0, 0, 0 },
            {2687350666666, 1314215000000, 0, 325439375000, 0, 88752572916, 42421942708, 0, 10430759114, 5486485677, 0, 1339653157, 0, 355364990, 204780415, 111810923, 67242284, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2687350666666, 1314215000000, 0, 325439375000, 0, 88752572916, 42421942708, 0, 10430759114, 5486485677, 0, 1339653157, 0, 355364990, 204780415, 111810923, 67242284, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2687350666666, 1314215000000, 0, 325439375000, 0, 88752572916, 42421942708, 0, 10430759114, 5486485677, 0, 1339653157, 0, 355364990, 204780415, 111810923, 67242284, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1423183000000, 707251500000, 346342458333, 171158041666, 90058364583, 40078026041, 22136617187, 11173502604, 5130205078, 2694508463, 1415776692, 0, 0, 204334350, 0, 60953552, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1423183000000, 707251500000, 346342458333, 171158041666, 90058364583, 40078026041, 22136617187, 11173502604, 5130205078, 2694508463, 1415776692, 0, 0, 204334350, 0, 60953552, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2853786666666, 1425278833333, 712427750000, 0, 178815708333, 88999291666, 0, 21972252604, 0, 0, 0, 1421142252, 710286539, 0, 0, 0, 0, 0, 31384869, 0, 0, 0, 0, 0, 0 },
            {2853786666666, 1425278833333, 712427750000, 0, 178815708333, 88999291666, 0, 21972252604, 0, 0, 0, 1421142252, 710286539, 0, 0, 0, 0, 0, 31384869, 0, 0, 0, 0, 0, 0 },
            {2853786666666, 1425278833333, 712427750000, 0, 178815708333, 88999291666, 0, 21972252604, 0, 0, 0, 1421142252, 710286539, 0, 0, 0, 0, 0, 31384869, 0, 0, 0, 0, 0, 0 },
            {2580166666666, 1282538666666, 659028333333, 319480250000, 155492187500, 77297395833, 40128005208, 20308307291, 10144445312, 5029770182, 2420232747, 1258606608, 648366292, 354291219, 180576822, 109333699, 63024805, 44161394, 31921424, 0, 0, 0, 0, 0, 0 },
            {2580166666666, 1282538666666, 659028333333, 319480250000, 155492187500, 77297395833, 40128005208, 20308307291, 10144445312, 5029770182, 2420232747, 1258606608, 648366292, 354291219, 180576822, 109333699, 63024805, 44161394, 31921424, 0, 0, 0, 0, 0, 0 },
            {2580166666666, 1282538666666, 659028333333, 319480250000, 155492187500, 77297395833, 40128005208, 20308307291, 10144445312, 5029770182, 2420232747, 1258606608, 648366292, 354291219, 180576822, 109333699, 63024805, 44161394, 31921424, 0, 0, 0, 0, 0, 0 },
            {2823851666666, 0, 0, 350650125000, 172456062500, 0, 42452713541, 21223989583, 10811450520, 0, 0, 1430467936, 0, 0, 194251159, 0, 67082738, 0, 32447283, 0, 0, 0, 0, 0, 0 },
            {2823851666666, 0, 0, 350650125000, 172456062500, 0, 42452713541, 21223989583, 10811450520, 0, 0, 1430467936, 0, 0, 194251159, 0, 67082738, 0, 32447283, 0, 0, 0, 0, 0, 0 },
            {2823851666666, 0, 0, 350650125000, 172456062500, 0, 42452713541, 21223989583, 10811450520, 0, 0, 1430467936, 0, 0, 194251159, 0, 67082738, 0, 32447283, 0, 0, 0, 0, 0, 0 },
            {2848781333333, 0, 0, 351472958333, 0, 88806239583, 0, 0, 0, 0, 2769540364, 1414107259, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2848781333333, 0, 0, 351472958333, 0, 88806239583, 0, 0, 0, 0, 2769540364, 1414107259, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2848781333333, 0, 0, 351472958333, 0, 88806239583, 0, 0, 0, 0, 2769540364, 1414107259, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 720768500000, 355239666666, 175938458333, 90861781250, 0, 22159546875, 10648992187, 5558515625, 2814137695, 1359857096, 0, 377511515, 204867268, 111021840, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 720768500000, 355239666666, 175938458333, 90861781250, 0, 22159546875, 10648992187, 5558515625, 2814137695, 1359857096, 0, 377511515, 204867268, 111021840, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1406509333333, 714684750000, 362284041666, 0, 90880854166, 0, 0, 11236562500, 5603501302, 0, 0, 699153971, 0, 195780598, 111217325, 66288452, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1406509333333, 714684750000, 362284041666, 0, 90880854166, 0, 0, 11236562500, 5603501302, 0, 0, 699153971, 0, 195780598, 111217325, 66288452, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1406509333333, 714684750000, 362284041666, 0, 90880854166, 0, 0, 11236562500, 5603501302, 0, 0, 699153971, 0, 195780598, 111217325, 66288452, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20900981, 12334780, 7391660, 5015560, 3730397, 3162744 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20900981, 12334780, 7391660, 5015560, 3730397, 3162744 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20021254, 10984970, 5902337, 3620432, 2588354, 1907627 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20021254, 10984970, 5902337, 3620432, 2588354, 1907627 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22684467, 13150540, 8952965, 6417060, 5273852, 4649243 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22684467, 13150540, 8952965, 6417060, 5273852, 4649243 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21907162, 12043754, 7600759, 5226690, 4568370, 3485006 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21907162, 12043754, 7600759, 5226690, 4568370, 3485006 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19975636, 11067091, 6386102, 3838057, 2712888, 2063934 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19975636, 11067091, 6386102, 3838057, 2712888, 2063934 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13945035, 9264540, 7357507, 6472377, 5246004 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13945035, 9264540, 7357507, 6472377, 5246004 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22082103, 12563943, 7870652, 5350601, 4572843, 3864605 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22082103, 12563943, 7870652, 5350601, 4572843, 3864605 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22082103, 12563943, 7870652, 5350601, 4572843, 3864605 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20017773, 10413178, 5687500, 3739352, 2729260, 2139195 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20017773, 10413178, 5687500, 3739352, 2729260, 2139195 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20017773, 10413178, 5687500, 3739352, 2729260, 2139195 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23580876, 15091670, 10276140, 7664453, 6878381, 5825312 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23580876, 15091670, 10276140, 7664453, 6878381, 5825312 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23580876, 15091670, 10276140, 7664453, 6878381, 5825312 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15945389, 11062418, 8664407, 7748828, 7070252 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15945389, 11062418, 8664407, 7748828, 7070252 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15703719, 14582259, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15703719, 14582259, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14727870, 10911932, 8983290, 7582592, 7019738 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14727870, 10911932, 8983290, 7582592, 7019738 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18308080, 17030340, 14708845, 13993850 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18308080, 17030340, 14708845, 13993850 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18308080, 17030340, 14708845, 13993850 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24739264, 15656789, 11057982, 8823348, 7880512, 7026697 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24739264, 15656789, 11057982, 8823348, 7880512, 7026697 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24739264, 15656789, 11057982, 8823348, 7880512, 7026697 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18379726, 16044424, 14661453, 14037687 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18379726, 16044424, 14661453, 14037687 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18379726, 16044424, 14661453, 14037687 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25455939, 15210775, 11117147, 9064278, 7718637, 7071733 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25455939, 15210775, 11117147, 9064278, 7718637, 7071733 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25455939, 15210775, 11117147, 9064278, 7718637, 7071733 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19857213, 14604519, 11734238, 10471611, 9868769 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19857213, 14604519, 11734238, 10471611, 9868769 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19857213, 14604519, 11734238, 10471611, 9868769 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21673983, 13110501, 8611329, 7329105, 4724193, 4046003 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21673983, 13110501, 8611329, 7329105, 4724193, 4046003 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21673983, 13110501, 8611329, 7329105, 4724193, 4046003 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19833091, 16859579, 15719214, 15143313 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21604854, 16985468, 14341807, 13027678, 12338333 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21604854, 16985468, 14341807, 13027678, 12338333 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21604854, 16985468, 14341807, 13027678, 12338333 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13995808, 9088255, 6742645, 5446717, 4829871 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13995808, 9088255, 6742645, 5446717, 4829871 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13995808, 9088255, 6742645, 5446717, 4829871 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16542670, 14198517, 12953796, 12902914 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16542670, 14198517, 12953796, 12902914 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16542670, 14198517, 12953796, 12902914 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25419212, 14294028, 9082061, 6617652, 5583518, 4969530 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25419212, 14294028, 9082061, 6617652, 5583518, 4969530 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25419212, 14294028, 9082061, 6617652, 5583518, 4969530 },
            {2492034000000, 0, 653978333333, 325543791666, 167639416666, 84095770833, 39948104166, 19720421875, 10217815104, 4730158854, 2674845703, 1256208170, 613864501, 307838175, 163721964, 77046203, 41390655, 21202115, 12796712, 7373816, 5332104, 3929724, 3284628, 2996292, 2698915 },
            {2492034000000, 0, 653978333333, 325543791666, 167639416666, 84095770833, 39948104166, 19720421875, 10217815104, 4730158854, 2674845703, 1256208170, 613864501, 307838175, 163721964, 77046203, 41390655, 21202115, 12796712, 7373816, 5332104, 3929724, 3284628, 2996292, 2698915 },
            {2499171666666, 1354744333333, 669912500000, 336021083333, 169774666666, 85964697916, 39998161458, 19323861979, 10271990885, 4801513020, 2596681640, 1275607910, 611127848, 292758707, 159400329, 88080098, 47660471, 25840555, 14959545, 10742918, 8145153, 6384294, 5875916, 5170312, 5021850 },
            {2499171666666, 1354744333333, 669912500000, 336021083333, 169774666666, 85964697916, 39998161458, 19323861979, 10271990885, 4801513020, 2596681640, 1275607910, 611127848, 292758707, 159400329, 88080098, 47660471, 25840555, 14959545, 10742918, 8145153, 6384294, 5875916, 5170312, 5021850 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 709880940, 340104817, 186075968, 90488413, 46025487, 24687540, 12644320, 7240757, 4257390, 2706034, 2064775, 1739185, 1442652 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 709880940, 340104817, 186075968, 90488413, 46025487, 24687540, 12644320, 7240757, 4257390, 2706034, 2064775, 1739185, 1442652 },
            {2510850000000, 1349923000000, 692730500000, 350595166666, 167101958333, 82589260416, 38001614583, 19934083333, 11157369791, 5049309895, 2654055013, 1247869628, 624293619, 304952229, 158587422, 76956542, 40016983, 20934282, 11384188, 6481763, 3877563, 2663364, 1990916, 1630581, 1450764 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 719565592, 0, 192252888, 0, 50554168, 28585632, 16457644, 10284461, 7058483, 5817893, 5413934, 4515721, 4318778 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 719565592, 0, 192252888, 0, 50554168, 28585632, 16457644, 10284461, 7058483, 5817893, 5413934, 4515721, 4318778 },
            {0, 0, 0, 0, 130858854166, 65089708333, 31929463541, 16026562500, 8013419270, 4067502604, 2038791666, 1038617187, 504592285, 251415852, 130989034, 67008992, 34496266, 17930117, 10010742, 5626752, 3575506, 2427768, 1914846, 1620184, 1503233 },
            {0, 0, 0, 0, 130858854166, 65089708333, 31929463541, 16026562500, 8013419270, 4067502604, 2038791666, 1038617187, 504592285, 251415852, 130989034, 67008992, 34496266, 17930117, 10010742, 5626752, 3575506, 2427768, 1914846, 1620184, 1503233 },
            {0, 0, 0, 0, 130858854166, 65089708333, 31929463541, 16026562500, 8013419270, 4067502604, 2038791666, 1038617187, 504592285, 251415852, 130989034, 67008992, 34496266, 17930117, 10010742, 5626752, 3575506, 2427768, 1914846, 1620184, 1503233 },
            {2431504000000, 1205970666666, 615004333333, 304960625000, 157091541666, 76790447916, 37560223958, 18817781250, 9416535156, 4787705729, 2433742838, 1192077311, 606080159, 298487996, 155444274, 80735758, 44613927, 23220720, 13991537, 8011416, 5401224, 4306954, 3450348, 3240650, 3007328 },
            {2431504000000, 1205970666666, 615004333333, 304960625000, 157091541666, 76790447916, 37560223958, 18817781250, 9416535156, 4787705729, 2433742838, 1192077311, 606080159, 298487996, 155444274, 80735758, 44613927, 23220720, 13991537, 8011416, 5401224, 4306954, 3450348, 3240650, 3007328 },
            {2351602333333, 1227585500000, 623847416666, 310263083333, 148689104166, 75073125000, 37491109375, 18715895833, 9620065104, 4820486328, 2422128906, 1180641276, 587285563, 309343709, 160323791, 83136220, 46030807, 26444465, 15314806, 11353121, 9296806, 7601197, 6356755, 6353312, 5612098 },
            {2351602333333, 1227585500000, 623847416666, 310263083333, 148689104166, 75073125000, 37491109375, 18715895833, 9620065104, 4820486328, 2422128906, 1180641276, 587285563, 309343709, 160323791, 83136220, 46030807, 26444465, 15314806, 11353121, 9296806, 7601197, 6356755, 6353312, 5612098 },
            {2836966333333, 0, 724942416666, 352953250000, 179049437500, 0, 42634088541, 0, 0, 5398485026, 0, 0, 692090494, 337704223, 179048116, 94239196, 43546656, 24812454, 13656906, 6782343, 4381453, 2812084, 2001677, 1711982, 1526331 },
            {2836966333333, 0, 724942416666, 352953250000, 179049437500, 0, 42634088541, 0, 0, 5398485026, 0, 0, 692090494, 337704223, 179048116, 94239196, 43546656, 24812454, 13656906, 6782343, 4381453, 2812084, 2001677, 1711982, 1526331 },
            {2399210666666, 1234042833333, 621706250000, 310934958333, 151379458333, 78770156250, 38299395833, 19321263020, 9654000000, 4784111979, 2348733398, 1160323242, 574796549, 296081380, 156091105, 77293599, 39951314, 21419448, 11260403, 6400182, 3825222, 2700159, 2072872, 1689743, 1545353 },
            {0, 0, 0, 361627875000, 171807937500, 0, 0, 0, 0, 0, 2678250976, 0, 709070475, 367377604, 186668619, 97777628, 57201777, 26560310, 17667816, 10279651, 8036716, 6324279, 5431002, 5382597, 4984507 },
            {0, 0, 0, 361627875000, 171807937500, 0, 0, 0, 0, 0, 2678250976, 0, 709070475, 367377604, 186668619, 97777628, 57201777, 26560310, 17667816, 10279651, 8036716, 6324279, 5431002, 5382597, 4984507 },
            {2447593000000, 1222616333333, 595844583333, 295963500000, 151398562500, 76229500000, 38020822916, 19189169270, 9427402343, 4667077473, 2379964843, 1206884928, 596401123, 304572916, 154508422, 79633219, 43597747, 23734959, 13544932, 8434185, 5953116, 4420583, 4148392, 3466962, 3562047 },
            {2447593000000, 1222616333333, 595844583333, 295963500000, 151398562500, 76229500000, 38020822916, 19189169270, 9427402343, 4667077473, 2379964843, 1206884928, 596401123, 304572916, 154508422, 79633219, 43597747, 23734959, 13544932, 8434185, 5953116, 4420583, 4148392, 3466962, 3562047 },
            {2447593000000, 1222616333333, 595844583333, 295963500000, 151398562500, 76229500000, 38020822916, 19189169270, 9427402343, 4667077473, 2379964843, 1206884928, 596401123, 304572916, 154508422, 79633219, 43597747, 23734959, 13544932, 8434185, 5953116, 4420583, 4148392, 3466962, 3562047 },
            {2502513333333, 1239591333333, 598061250000, 299168416666, 148559604166, 73580229166, 38298916666, 19148375000, 9646207031, 4841250000, 2417814453, 1147762369, 594397542, 320756998, 166747802, 82947855, 51100199, 26531687, 16692353, 11820686, 8786728, 7597360, 7065479, 6776475, 6190994 },
            {2502513333333, 1239591333333, 598061250000, 299168416666, 148559604166, 73580229166, 38298916666, 19148375000, 9646207031, 4841250000, 2417814453, 1147762369, 594397542, 320756998, 166747802, 82947855, 51100199, 26531687, 16692353, 11820686, 8786728, 7597360, 7065479, 6776475, 6190994 },
            {2502513333333, 1239591333333, 598061250000, 299168416666, 148559604166, 73580229166, 38298916666, 19148375000, 9646207031, 4841250000, 2417814453, 1147762369, 594397542, 320756998, 166747802, 82947855, 51100199, 26531687, 16692353, 11820686, 8786728, 7597360, 7065479, 6776475, 6190994 },
            {2818046000000, 1378025500000, 0, 0, 178281625000, 89587697916, 0, 0, 11114858072, 0, 2772629557, 1414218587, 0, 354416544, 178331949, 87985168, 46398468, 24489402, 13110759, 7757681, 4437295, 2941644, 2247976, 1858987, 1815380 },
            {2818046000000, 1378025500000, 0, 0, 178281625000, 89587697916, 0, 0, 11114858072, 0, 2772629557, 1414218587, 0, 354416544, 178331949, 87985168, 46398468, 24489402, 13110759, 7757681, 4437295, 2941644, 2247976, 1858987, 1815380 },
            {2818046000000, 1378025500000, 0, 0, 178281625000, 89587697916, 0, 0, 11114858072, 0, 2772629557, 1414218587, 0, 354416544, 178331949, 87985168, 46398468, 24489402, 13110759, 7757681, 4437295, 2941644, 2247976, 1858987, 1815380 },
            {2423898666666, 1239144500000, 602577083333, 305697833333, 158218000000, 79222229166, 39103869791, 19911757812, 9930022135, 4934154947, 2456772786, 1242529622, 608670247, 313395751, 0, 78092458, 40618835, 21199452, 11524486, 6317211, 4088867, 2826230, 2009076, 1757101, 1596154 },
            {2423898666666, 1239144500000, 602577083333, 305697833333, 158218000000, 79222229166, 39103869791, 19911757812, 9930022135, 4934154947, 2456772786, 1242529622, 608670247, 313395751, 0, 78092458, 40618835, 21199452, 11524486, 6317211, 4088867, 2826230, 2009076, 1757101, 1596154 },
            {2849944333333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365622762, 181538004, 97637145, 54948028, 29565989, 18254603, 11195341, 9090189, 7117503, 6265663, 5847797, 5700115 },
            {2849944333333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365622762, 181538004, 97637145, 54948028, 29565989, 18254603, 11195341, 9090189, 7117503, 6265663, 5847797, 5700115 },
            {2849944333333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365622762, 181538004, 97637145, 54948028, 29565989, 18254603, 11195341, 9090189, 7117503, 6265663, 5847797, 5700115 },
            {0, 0, 0, 0, 132475791666, 67091989583, 32891526041, 16583588541, 8288533854, 4248789062, 2029726236, 1039690429, 508409830, 256317504, 130754089, 67513458, 34805547, 19159027, 10544682, 6104819, 3875182, 2611872, 2319075, 1768892, 1655172 },
            {0, 0, 0, 0, 132475791666, 67091989583, 32891526041, 16583588541, 8288533854, 4248789062, 2029726236, 1039690429, 508409830, 256317504, 130754089, 67513458, 34805547, 19159027, 10544682, 6104819, 3875182, 2611872, 2319075, 1768892, 1655172 },
            {0, 0, 0, 0, 132475791666, 67091989583, 32891526041, 16583588541, 8288533854, 4248789062, 2029726236, 1039690429, 508409830, 256317504, 130754089, 67513458, 34805547, 19159027, 10544682, 6104819, 3875182, 2611872, 2319075, 1768892, 1655172 },
            {0, 0, 0, 0, 132475791666, 67091989583, 32891526041, 16583588541, 8288533854, 4248789062, 2029726236, 1039690429, 508409830, 256317504, 130754089, 67513458, 34805547, 19159027, 10544682, 6104819, 3875182, 2611872, 2319075, 1768892, 1655172 },
            {2579939666666, 1343971500000, 0, 344729583333, 167863020833, 85195614583, 43243927083, 20482085937, 9786554687, 5077644531, 2744358723, 1370885742, 649787027, 339320353, 185045471, 101510843, 60166320, 40103454, 28724548, 23331281, 0, 0, 0, 0, 0 },
            {2579939666666, 1343971500000, 0, 344729583333, 167863020833, 85195614583, 43243927083, 20482085937, 9786554687, 5077644531, 2744358723, 1370885742, 649787027, 339320353, 185045471, 101510843, 60166320, 40103454, 28724548, 23331281, 0, 0, 0, 0, 0 },
            {2422190000000, 1330509500000, 685272750000, 0, 169368854166, 84233697916, 41944994791, 19930041666, 10078186197, 4923335937, 2751111653, 1347752604, 675969482, 350195149, 175237060, 0, 58937357, 39765843, 28558713, 22790222, 0, 0, 0, 0, 0 },
            {2422190000000, 1330509500000, 685272750000, 0, 169368854166, 84233697916, 41944994791, 19930041666, 10078186197, 4923335937, 2751111653, 1347752604, 675969482, 350195149, 175237060, 0, 58937357, 39765843, 28558713, 22790222, 0, 0, 0, 0, 0 },
            {2518361000000, 1383683500000, 688525333333, 0, 179521333333, 85415208333, 41405989583, 20573971354, 11017028645, 4986968750, 2758455403, 0, 674032470, 344753865, 200196146, 105379414, 60328486, 38418334, 30007807, 23573218, 0, 0, 0, 0, 0 },
            {2518361000000, 1383683500000, 688525333333, 0, 179521333333, 85415208333, 41405989583, 20573971354, 11017028645, 4986968750, 2758455403, 0, 674032470, 344753865, 200196146, 105379414, 60328486, 38418334, 30007807, 23573218, 0, 0, 0, 0, 0 },
            {2528775333333, 1403428833333, 694701333333, 353273666666, 0, 85841989583, 40293473958, 20340828125, 10257957031, 5071182291, 2780063476, 1409242350, 686929117, 345667277, 191300679, 107776245, 58805694, 36507573, 27382859, 22237595, 0, 0, 0, 0, 0 },
            {2664529000000, 0, 716103083333, 355659666666, 173210916666, 89637510416, 40686312500, 20067182291, 10545589843, 5050681640, 2605430338, 1383353841, 678876790, 346366007, 186468261, 99470235, 62130859, 40109626, 26277111, 0, 19064295, 0, 0, 0, 0 },
            {2664529000000, 0, 716103083333, 355659666666, 173210916666, 89637510416, 40686312500, 20067182291, 10545589843, 5050681640, 2605430338, 1383353841, 678876790, 346366007, 186468261, 99470235, 62130859, 40109626, 26277111, 0, 19064295, 0, 0, 0, 0 },
            {2600048000000, 1281707833333, 626379083333, 314793666666, 165667354166, 79459510416, 41012510416, 19463932291, 9786790364, 4927599609, 2541858072, 1245477050, 654479003, 355252563, 180621398, 100170969, 63172058, 39718233, 30832612, 25389293, 0, 0, 0, 0, 0 },
            {2600048000000, 1281707833333, 626379083333, 314793666666, 165667354166, 79459510416, 41012510416, 19463932291, 9786790364, 4927599609, 2541858072, 1245477050, 654479003, 355252563, 180621398, 100170969, 63172058, 39718233, 30832612, 25389293, 0, 0, 0, 0, 0 },
            {2600048000000, 1281707833333, 626379083333, 314793666666, 165667354166, 79459510416, 41012510416, 19463932291, 9786790364, 4927599609, 2541858072, 1245477050, 654479003, 355252563, 180621398, 100170969, 63172058, 39718233, 30832612, 25389293, 0, 0, 0, 0, 0 },
            {2572206000000, 1252645166666, 618127750000, 317944583333, 157868187500, 78673375000, 38486812500, 19726026041, 9993321614, 4804779947, 2568757486, 1271539062, 648238525, 338446899, 183493245, 105037902, 62901423, 40441502, 31346238, 0, 0, 0, 0, 0, 0 },
            {2572206000000, 1252645166666, 618127750000, 317944583333, 157868187500, 78673375000, 38486812500, 19726026041, 9993321614, 4804779947, 2568757486, 1271539062, 648238525, 338446899, 183493245, 105037902, 62901423, 40441502, 31346238, 0, 0, 0, 0, 0, 0 },
            {2572206000000, 1252645166666, 618127750000, 317944583333, 157868187500, 78673375000, 38486812500, 19726026041, 9993321614, 4804779947, 2568757486, 1271539062, 648238525, 338446899, 183493245, 105037902, 62901423, 40441502, 31346238, 0, 0, 0, 0, 0, 0 },
            {2529227666666, 1296974166666, 634722916666, 311933500000, 155913541666, 77586197916, 40604765625, 19736708333, 10074191406, 4940228515, 2506289388, 1289821940, 653309326, 350857218, 187816121, 109067911, 63772333, 0, 30357041, 0, 0, 0, 0, 0, 0 },
            {2529227666666, 1296974166666, 634722916666, 311933500000, 155913541666, 77586197916, 40604765625, 19736708333, 10074191406, 4940228515, 2506289388, 1289821940, 653309326, 350857218, 187816121, 109067911, 63772333, 0, 30357041, 0, 0, 0, 0, 0, 0 },
            {2529227666666, 1296974166666, 634722916666, 311933500000, 155913541666, 77586197916, 40604765625, 19736708333, 10074191406, 4940228515, 2506289388, 1289821940, 653309326, 350857218, 187816121, 109067911, 63772333, 0, 30357041, 0, 0, 0, 0, 0, 0 },
            {2604454000000, 1254981833333, 624211750000, 305286458333, 162075812500, 79852979166, 39891203125, 19721255208, 9845118489, 5091917968, 2512908203, 1291769694, 671110839, 357885742, 187938700, 100934448, 59281997, 41694175, 0, 0, 0, 0, 0, 0, 0 },
            {2669257333333, 1271134333333, 625871666666, 325798958333, 162729062500, 79814468750, 40032744791, 20136598958, 10170350260, 4958519531, 2481518554, 1252043619, 662102783, 341630574, 187206685, 100403594, 62071833, 40808792, 31061742, 25152924, 22344585, 0, 0, 0, 0 },
            {2669257333333, 1271134333333, 625871666666, 325798958333, 162729062500, 79814468750, 40032744791, 20136598958, 10170350260, 4958519531, 2481518554, 1252043619, 662102783, 341630574, 187206685, 100403594, 62071833, 40808792, 31061742, 25152924, 22344585, 0, 0, 0, 0 },
            {2669257333333, 1271134333333, 625871666666, 325798958333, 162729062500, 79814468750, 40032744791, 20136598958, 10170350260, 4958519531, 2481518554, 1252043619, 662102783, 341630574, 187206685, 100403594, 62071833, 40808792, 31061742, 25152924, 22344585, 0, 0, 0, 0 },
            {2440834333333, 1237485166666, 0, 308382750000, 151710416666, 78567333333, 40872369791, 20110135416, 9884485677, 4986522786, 2498888020, 1217841308, 670111002, 341561971, 187872090, 0, 61032236, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2440834333333, 1237485166666, 0, 308382750000, 151710416666, 78567333333, 40872369791, 20110135416, 9884485677, 4986522786, 2498888020, 1217841308, 670111002, 341561971, 187872090, 0, 61032236, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2440834333333, 1237485166666, 0, 308382750000, 151710416666, 78567333333, 40872369791, 20110135416, 9884485677, 4986522786, 2498888020, 1217841308, 670111002, 341561971, 187872090, 0, 61032236, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2475329666666, 1249451333333, 635652500000, 0, 161808041666, 79024593750, 39981572916, 20422388020, 9746416666, 4900503255, 2493976562, 1283131835, 649467529, 340140502, 0, 104421427, 64043594, 44318806, 0, 0, 0, 0, 0, 0, 0 },
            {2475329666666, 1249451333333, 635652500000, 0, 161808041666, 79024593750, 39981572916, 20422388020, 9746416666, 4900503255, 2493976562, 1283131835, 649467529, 340140502, 0, 104421427, 64043594, 44318806, 0, 0, 0, 0, 0, 0, 0 },
            {2475329666666, 1249451333333, 635652500000, 0, 161808041666, 79024593750, 39981572916, 20422388020, 9746416666, 4900503255, 2493976562, 1283131835, 649467529, 340140502, 0, 104421427, 64043594, 44318806, 0, 0, 0, 0, 0, 0, 0 },
            {2524765333333, 1268412500000, 643997666666, 310408125000, 159052104166, 79046656250, 39890588541, 19837289062, 10125214843, 5083920572, 2492053385, 1299641276, 661006266, 335459269, 185301757, 109853027, 64959299, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2524765333333, 1268412500000, 643997666666, 310408125000, 159052104166, 79046656250, 39890588541, 19837289062, 10125214843, 5083920572, 2492053385, 1299641276, 661006266, 335459269, 185301757, 109853027, 64959299, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2524765333333, 1268412500000, 643997666666, 310408125000, 159052104166, 79046656250, 39890588541, 19837289062, 10125214843, 5083920572, 2492053385, 1299641276, 661006266, 335459269, 185301757, 109853027, 64959299, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2517990000000, 1242246166666, 633174250000, 312064125000, 155784375000, 76946145833, 40112942708, 19944119791, 10211609375, 4969453776, 2541535807, 1276239746, 646628824, 346767659, 186083414, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2517990000000, 1242246166666, 633174250000, 312064125000, 155784375000, 76946145833, 40112942708, 19944119791, 10211609375, 4969453776, 2541535807, 1276239746, 646628824, 346767659, 186083414, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2667083333333, 1241807666666, 644708833333, 324583208333, 158526520833, 78272552083, 40436333333, 18978812500, 10029497395, 5178468750, 2390324544, 1288533854, 663951171, 364327026, 193684387, 100893981, 66553431, 42787404, 0, 0, 0, 0, 0, 0, 0 },
            {2667083333333, 1241807666666, 644708833333, 324583208333, 158526520833, 78272552083, 40436333333, 18978812500, 10029497395, 5178468750, 2390324544, 1288533854, 663951171, 364327026, 193684387, 100893981, 66553431, 42787404, 0, 0, 0, 0, 0, 0, 0 },
            {2667083333333, 1241807666666, 644708833333, 324583208333, 158526520833, 78272552083, 40436333333, 18978812500, 10029497395, 5178468750, 2390324544, 1288533854, 663951171, 364327026, 193684387, 100893981, 66553431, 42787404, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1371985666666, 0, 0, 178181916666, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28866422, 0, 0, 0, 0, 0, 0 },
            {0, 1371985666666, 0, 0, 178181916666, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28866422, 0, 0, 0, 0, 0, 0 },
            {2813786000000, 1370936333333, 0, 0, 0, 89173531250, 42738947916, 0, 10974876302, 5582164062, 0, 1361566894, 0, 0, 0, 110265625, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42065020, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42065020, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 21970960937, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 21970960937, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 1419842833333, 726220333333, 0, 0, 0, 0, 0, 0, 0, 0, 1396732584, 0, 0, 0, 109119394, 0, 0, 30522916, 0, 0, 0, 0, 0, 0 },
            {0, 1419842833333, 726220333333, 0, 0, 0, 0, 0, 0, 0, 0, 1396732584, 0, 0, 0, 109119394, 0, 0, 30522916, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 202642171, 0, 0, 41340148, 32036028, 0, 22181860, 0, 0, 0, 18203270 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 202642171, 0, 0, 41340148, 32036028, 0, 22181860, 0, 0, 0, 18203270 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 202642171, 0, 0, 41340148, 32036028, 0, 22181860, 0, 0, 0, 18203270 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64767949, 41846071, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42838297, 31244107, 24692598, 21760270, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29792767, 24162878, 20834986, 0, 19033104, 18306442, 17992745 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29792767, 24162878, 20834986, 0, 19033104, 18306442, 17992745 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29792767, 24162878, 20834986, 0, 19033104, 18306442, 17992745 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 66856196, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 66856196, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 5615354166, 0, 0, 0, 0, 0, 0, 0, 42098762, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 711405083333, 0, 0, 0, 0, 0, 0, 5559071614, 0, 0, 711399576, 0, 0, 0, 64931315, 0, 0, 24805355, 0, 0, 0, 0, 0 },
            {0, 0, 711405083333, 0, 0, 0, 0, 0, 0, 5559071614, 0, 0, 711399576, 0, 0, 0, 64931315, 0, 0, 24805355, 0, 0, 0, 0, 0 },
            {0, 0, 711405083333, 0, 0, 0, 0, 0, 0, 5559071614, 0, 0, 711399576, 0, 0, 0, 64931315, 0, 0, 24805355, 0, 0, 0, 0, 0 },
            {2530557666666, 1326312500000, 666412750000, 335078416666, 163496458333, 82345875000, 38879906250, 19959656250, 10163721354, 4822289713, 2527773111, 1399909830, 630934895, 340600667, 183814168, 107938741, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2530557666666, 1326312500000, 666412750000, 335078416666, 163496458333, 82345875000, 38879906250, 19959656250, 10163721354, 4822289713, 2527773111, 1399909830, 630934895, 340600667, 183814168, 107938741, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2530557666666, 1326312500000, 666412750000, 335078416666, 163496458333, 82345875000, 38879906250, 19959656250, 10163721354, 4822289713, 2527773111, 1399909830, 630934895, 340600667, 183814168, 107938741, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2569977666666, 1358581666666, 670807416666, 317667083333, 164805979166, 83645760416, 38581239583, 19294434895, 10244307291, 5036599609, 2621629557, 1229889160, 673004150, 345295410, 191483011, 111290456, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2569977666666, 1358581666666, 670807416666, 317667083333, 164805979166, 83645760416, 38581239583, 19294434895, 10244307291, 5036599609, 2621629557, 1229889160, 673004150, 345295410, 191483011, 111290456, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2569977666666, 1358581666666, 670807416666, 317667083333, 164805979166, 83645760416, 38581239583, 19294434895, 10244307291, 5036599609, 2621629557, 1229889160, 673004150, 345295410, 191483011, 111290456, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {2586546666666, 1326096000000, 696320500000, 345602291666, 166242520833, 81933208333, 39942052083, 19887026041, 10403743489, 5030539713, 0, 1307452799, 669242431, 348734781, 199731445, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 381900756, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
            {1183328666666, 587216166666, 296696916666, 147389166666, 71885000000, 37973458333, 18271401041, 9126526041, 4637617187, 2230108072, 1144950195, 580498860, 279479329, 154677327, 81803588, 42502827, 27481135, 17725797, 11955268, 8940471, 6812103, 6222282, 6389671, 5909306, 5648798 },
            {1183328666666, 587216166666, 296696916666, 147389166666, 71885000000, 37973458333, 18271401041, 9126526041, 4637617187, 2230108072, 1144950195, 580498860, 279479329, 154677327, 81803588, 42502827, 27481135, 17725797, 11955268, 8940471, 6812103, 6222282, 6389671, 5909306, 5648798 },
            {1156343666666, 579683166666, 291940416666, 146651500000, 74744854166, 36100156250, 17934536458, 9369111979, 4634687500, 2260590494, 1167553059, 588411458, 298894449, 158239624, 87245300, 48507446, 27298934, 16510205, 10610158, 10263275, 7744788, 6792145, 6598567, 6272261, 6420899 },
            {1156343666666, 579683166666, 291940416666, 146651500000, 74744854166, 36100156250, 17934536458, 9369111979, 4634687500, 2260590494, 1167553059, 588411458, 298894449, 158239624, 87245300, 48507446, 27298934, 16510205, 10610158, 10263275, 7744788, 6792145, 6598567, 6272261, 6420899 },
            {1136255666666, 568616833333, 288405083333, 139081166666, 71026000000, 36318843750, 18541651041, 9076617187, 4409654947, 2331464843, 1187051106, 590145833, 297151855, 153936482, 83885152, 45887410, 30268315, 18033208, 12434319, 9713795, 8318701, 7593023, 7018031, 7161019, 6733838 },
            {1136255666666, 568616833333, 288405083333, 139081166666, 71026000000, 36318843750, 18541651041, 9076617187, 4409654947, 2331464843, 1187051106, 590145833, 297151855, 153936482, 83885152, 45887410, 30268315, 18033208, 12434319, 9713795, 8318701, 7593023, 7018031, 7161019, 6733838 },
            {1136255666666, 568616833333, 288405083333, 139081166666, 71026000000, 36318843750, 18541651041, 9076617187, 4409654947, 2331464843, 1187051106, 590145833, 297151855, 153936482, 83885152, 45887410, 30268315, 18033208, 12434319, 9713795, 8318701, 7593023, 7018031, 7161019, 6733838 }
    };

    // TODO: performance of INF horizon
    int64 horizon = INT64_MAX - 1;

    struct Task {
        sat::IntervalVar p_interval;
        sat::IntervalVar io_interval;
        int64 block_len;
    };

    std::size_t num_tasks = processors.size() * devices.size() * blocks.size();
    std::vector<sat::IntervalVar> all_p_intervals;
    std::vector<sat::IntVar> all_io_ends;

    std::vector<std::vector<sat::IntervalVar>> per_device_intervals(devices.size());

    std::vector<std::vector<std::vector<Task>>> all_tasks(processors.size());

    std::vector<sat::BoolVar> all_chosen;
    std::vector<int64> all_block_sizes;

    sat::CpModelBuilder cp_model;
    Domain domain(0, horizon);
    for (int proc_id = 0; proc_id < processors.size(); proc_id++)
    {
        if (sec_levels[proc_id] != SEC_LEVEL)
            continue;

        all_tasks[proc_id] = std::vector<std::vector<Task>>(blocks.size());
        for (int block_id = 0; block_id < blocks.size(); block_id++)
        {
            if (processors[proc_id][block_id] == 0)
                continue;
            all_tasks[proc_id][block_id] = std::vector<Task>(devices.size());
            for (int device_id = 0; device_id < devices.size(); device_id++)
            {
                std::stringstream ss;
                ss << "_" << block_id << "_" << proc_id << "_" << device_id;
                sat::BoolVar chosen = cp_model.NewBoolVar().WithName("chosen" + ss.str());
                all_chosen.push_back(chosen);
                all_block_sizes.push_back(blocks[block_id]);

                sat::IntVar p_time = cp_model.NewConstant(blocks[block_id] * processors[proc_id][block_id]);
                sat::IntVar p_start = cp_model.NewIntVar(domain).WithName("p_start" + ss.str());
                sat::IntVar p_end = cp_model.NewIntVar(domain).WithName("p_end" + ss.str());
                sat::IntervalVar p_interval = cp_model.NewOptionalIntervalVar(p_start, p_time, p_end, chosen).WithName("p_interval" + ss.str());

                all_p_intervals.push_back(p_interval);

                sat::IntVar io_time = cp_model.NewConstant(blocks[block_id] * devices[device_id]);
                sat::IntVar io_start = cp_model.NewIntVar(domain).WithName("io_start" + ss.str());
                sat::IntVar io_end = cp_model.NewIntVar(domain).WithName("io_end" + ss.str());
                sat::IntervalVar io_interval = cp_model.NewOptionalIntervalVar(io_end, io_time, io_end, chosen).WithName("io_interval" + ss.str());

                all_io_ends.push_back(io_end);
                per_device_intervals[device_id].push_back(io_interval);

                all_tasks[proc_id][block_id][device_id] = Task{p_interval, io_interval, blocks[block_id]};

                /// Precedence constraint
                cp_model.AddGreaterOrEqual(io_start, p_end).OnlyEnforceIf(chosen);
            }
        }
    }

    std::cout << "Finished preparing data" << std::endl;

    /// Constraints
    cp_model.AddNoOverlap(absl::Span<sat::IntervalVar>(all_p_intervals));
    for (int device_id = 0; device_id < devices.size(); device_id++)
    {
        cp_model.AddNoOverlap(absl::Span<sat::IntervalVar>(per_device_intervals[device_id]));
    }

    cp_model.AddBoolOr(absl::Span<sat::BoolVar>(all_chosen));

    cp_model.AddEquality(sat::LinearExpr::BooleanScalProd(absl::Span<sat::BoolVar>(all_chosen), absl::Span<int64>(all_block_sizes)), FILE_SIZE);

    /// Objective
    sat::IntVar obj_var = cp_model.NewIntVar(domain).WithName("makespan");
    cp_model.AddMaxEquality(obj_var, all_io_ends);
    cp_model.Minimize(obj_var);

    /// Solver
    sat::CpModelProto model_proto = cp_model.Build();
    sat::CpSolverResponse response = sat::Solve(model_proto);
    std::cout << sat::CpSolverResponseStats(response) << std::endl;

    if (response.status() == sat::CpSolverStatus::OPTIMAL || response.status() == sat::CpSolverStatus::FEASIBLE)
    {
        std::cout << "Optimal Schedule Length: " << sat::SolutionIntegerValue(response, obj_var) << "\n";
        std::stringstream processor_tasks;
        for (int proc_id = 0; proc_id < processors.size(); proc_id++)
        {
            if (sec_levels[proc_id] != SEC_LEVEL)
                continue;

            for (int device_id = 0; device_id < devices.size(); device_id++)
            {
                std::stringstream processor_times;
                bool print = false;
                for (int block_id = 0; block_id < blocks.size(); block_id++)
                {
                    if (processors[proc_id][block_id] == 0)
                        continue;

                    auto &task = all_tasks[proc_id][block_id][device_id];
                    if (!sat::SolutionBooleanValue(response, task.p_interval.PresenceBoolVar()))
                    {
                        continue;
                    }
                    print = true;

                    processor_tasks << std::setw(-30) << "block " << task.block_len << " B | ";

                    std::stringstream times;
                    times << "p: ["
                          << sat::SolutionIntegerValue(response, task.p_interval.StartVar()) << ", "
                          << sat::SolutionIntegerValue(response, task.p_interval.EndVar()) << "] ";

                    times << "io: ["
                          << sat::SolutionIntegerValue(response, task.io_interval.StartVar()) << ", "
                          << sat::SolutionIntegerValue(response, task.io_interval.EndVar()) << "] | ";

                    processor_times <<  std::setw(-30) << times.str();
                }
                if (print)
                {
                    processor_tasks << "Processor " << cipher_names[proc_id] << " by " << device_id << " : \n";
                    processor_tasks << "\n" << processor_times.str() << "\n";
                }
            }
        }


        std::cout << processor_tasks.str() << std::endl;

        SUCCEED();
        return;
    }

    FAIL();
}